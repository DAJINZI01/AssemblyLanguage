; 编程：当发生除法溢出是，在屏幕中间显示“overflow！”，返回DOS。

ASSUME CS:CODE

CODE SEGMENT
	START:
	; DO0安装程序
	MOV AX, CS
	MOV DS, AX
	MOV AX, 0000H
	MOV ES, AX
	MOV SI, OFFSET DO0
	MOV DI, 0200H
	MOV CX, OFFSET DO0_END - OFFSET DO0
	CLD
	REP MOVSB	
	; 设置中断向量表
	MOV AX, 0000H
	MOV DS, AX
	MOV WORD PTR DS:[0*4], 0200H
	MOV WORD PTR DS:[0*4+2], 0000H
	; 程序返回
	MOV AX, 4C00H
	INT 21H

	; DO0中断处理程序
	DO0:
	PUSH AX
	PUSH DS
	PUSH ES
	PUSH SI
	PUSH DI
	JMP SHORT DO0_START
	OVERFLOW DB 'overflow!', 0

	DO0_START:
	MOV AX, CS
	MOV DS, AX
	MOV AX, 0B800H
	MOV ES, AX
	MOV SI, 0200H + OFFSET OVERFLOW - OFFSET DO0
	MOV DI, 12 * 0A0H + 36 * 02H

	DO0_S:
	MOV AL, [SI]
	CMP AL, 00H
	JZ SHORT ZERO
	MOV ES:[DI], AL
	MOV BYTE PTR ES:[DI].01H, 04H
	INC SI
	ADD DI, 0002H
	LOOP DO0_S	

	ZERO:
	POP DI
	POP SI
	POP ES
	POP DS
	POP AX
	IRET

	DO0_END:
	NOP
	
CODE ENDS
	END START
