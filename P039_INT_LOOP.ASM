; 用int 7CH 实现LOOP 功能

ASSUME CS:CODE

CODE SEGMENT

	START:
		; COPY CODE:7CH TO 0000:0200
		MOV AX, CS
		MOV DS, AX
		MOV AX, 0000H
		MOV ES, AX
		
		MOV SI, OFFSET LOOP_7CH
		MOV DI, 0200H
		CLD
		MOV CX, OFFSET LOOP_7CH_END - OFFSET LOOP_7CH
		REP MOVSB
		; REWRITE 0000:01F0 - 0000:01F3
		MOV AX, 0000H
		MOV DS, AX
		MOV BX, 7CH * 4
		MOV WORD PTR [BX], 0200H
		MOV WORD PTR [BX].02H, 0000H
		; MAIN RETURN
		MOV AX, 4C00H
		INT 21H
		
		
	LOOP_7CH:
		PUSH BP
		MOV BP, SP
		DEC CX
		JCXZ RETURN
		ADD [BP+02H], BX
		
		RETURN:
			POP BP
			IRET
	LOOP_7CH_END:
		

CODE ENDS

END START