; 实现一个子程序 setscreen ,为显示提供如下功能：
;		1、清屏 将当前屏幕 将显存中当前屏幕中的字符设置为空格符
;		2、设置前景色 
;		3、设置背景色
;		4、向上滚动一行
;		入口参数说明：
;			1、用AH寄存器传递功能号
;			0
;			1
;			2
;			3
;			对于2/3号功能，用AL传送颜色值
;			AL = 0， 1， 2， 3， 4， 5， 6，7

ASSUME CS:CODE, DS:DATA, SS:STACK

DATA SEGMENT
	TABLE DW OFFSET CLEAR_SCREEN, OFFSET SET_FRONT_COLOR, OFFSET SET_BACKGROUND_COLOR, OFFSET SCORLL_UP
DATA ENDS

STACK SEGMENT
	DB 16 DUP (0)
STACK ENDS

CODE SEGMENT

	START:
		MOV AX, DATA
		MOV DS, AX
		MOV AX, STACK
		MOV SS, AX
		MOV SP, 0010H
	
		MOV AL, 03H
		MOV AH, 03H
		CALL FUNC
	
		MOV AX, 4C00H
		INT 21H
		
	FUNC:
		MOV BL, AL
		ADD BL, BL
		MOV BH, 00H
		CALL WORD PTR TABLE[BX]
		RET
		
	CLEAR_SCREEN:
		PUSH AX
		PUSH BX
		PUSH CX
		PUSH ES
		
		MOV AX, 0B800H
		MOV ES, AX
		MOV BX, 0000H
		MOV CX, 07D0H; 2000
		CLEAR_SCREEN_S:
			MOV BYTE PTR ES:[BX], ' '
			ADD BX, 0002H
			LOOP CLEAR_SCREEN_S
			
		POP ES
		POP CX
		POP BX
		POP AX
		RET
		
	SET_FRONT_COLOR:
		PUSH AX
		PUSH BX
		PUSH CX
		PUSH ES
		
		MOV BX, 0B800H
		MOV ES, BX
		MOV BX, 0000H
		
		MOV CL, 04H
		SHL AH, CL
		
		MOV CX, 07D0H; 2000
		SET_FRONT_COLOR_S:
			MOV AL, ES:[BX+1]
			AND AL, 8FH
			OR AL, AH
			MOV BYTE PTR ES:[BX+1], AL
			ADD BX, 0002H
			LOOP SET_FRONT_COLOR_S
			
		POP ES
		POP CX
		POP BX
		POP AX
		RET
		
	SET_BACKGROUND_COLOR:
		PUSH AX
		PUSH BX
		PUSH CX
		PUSH ES
		
		MOV BX, 0B800H
		MOV ES, BX
		MOV BX, 0000H
		
		MOV CX, 07D0H; 2000
		SET_BACKGROUND_COLOR_S:
			AND BYTE PTR ES:[BX+1], 0F0H
			OR BYTE PTR ES:[BX+1], AH
			ADD BX, 0002H
			LOOP SET_BACKGROUND_COLOR_S
			
		POP ES
		POP CX
		POP BX
		POP AX
		RET
	
	SCORLL_UP:
		PUSH AX
		PUSH BX
		PUSH CX
		PUSH ES
		PUSH DS
		
		MOV BX, 0B800H
		MOV DS, BX
		MOV ES, BX
		
		MOV SI, 00A0H
		MOV DI, 0000H
		CLD
		MOV CX, 0018H; 2000
		SCORLL_UP_S:
			PUSH CX
			MOV CX, 00A0H
			REP MOVSB
			POP CX
			LOOP SCORLL_UP_S
		MOV SI, 00A0H * 24
		MOV CX, 0050H
		; SCORLL_UP_LASTLINE_S:
			; MOV BYTE PTR [SI], ' '
			; ADD SI, 0002H
			; LOOP SCORLL_UP_LASTLINE_S

		POP DS
		POP ES
		POP CX
		POP BX
		POP AX
		RET
		
	
		
CODE ENDS

END START