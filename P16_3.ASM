; 编写子程序，以十六进制的形式在屏幕中间显示给定的字节型数据
; 编写子程序，计算sin(x), x = {0, 30, 60, 90, 120, 150, 180},并在屏幕中间显示计算结果。

ASSUME CS:CODE


CODE SEGMENT
	START:
	
	MOV AL, 1FH
	CALL SHOW_BYTE

	MOV AX, 60
	CALL SHOW_SIN

	MOV AX, 4C00H
	INT 21H

	SHOW_BYTE:
	JMP SHORT SHOW_BYTE_START
	TABLE DB '0123456789ABCEDF' 
	
	SHOW_BYTE_START:
	PUSH AX
	PUSH BX
	PUSH CX
	PUSH ES

	MOV AH,AL
	MOV CL, 04H
	SHR AH, CL
	AND AL, 0FH

	MOV BH, 00H
	MOV BL, AH
	MOV AH, TABLE[BX]
	MOV BL, AL
	MOV AL, TABLE[BX]
	
	MOV BX, 0B800H
	MOV ES, BX
	MOV BX, 12 * 0A0H + 4EH
	MOV ES:[BX], AH
	MOV BYTE PTR ES:[BX].01H, 03H
	ADD BX, 0002H
	MOV ES:[BX], AL
	MOV BYTE PTR ES:[BX].01H, 03H

	POP ES
	POP CX
	POP BX
	POP AX
	RET
	
	SHOW_SIN:
	PUSH AX
	PUSH BX
	PUSH SI
	PUSH DI
	PUSH ES

	JMP SHORT SHOW_SIN_START
	SIN_VALUES	DW SIN0, SIN30, SIN60, SIN90, SIN120, SIN150, SIN180
	SIN0		DB '0', 0
	SIN30		DB '0.5', 0
	SIN60		DB '0.866', 0
	SIN90		DB '1', 0
	SIN120		DB '0.866', 0
	SIN150		DB '0.5', 0
	SIN180		DB '0', 0

	SHOW_SIN_START:
	MOV BL, 1EH
	DIV BL
	MOV BL, 02H
	MUL BL
	MOV BX, AX
	
	MOV BX, SIN_VALUES[BX]

	MOV AX, 0B800H
	MOV ES, AX
	MOV DI, 12 * 0A0H + 4EH
	MOV SI, 0000H 
	SHOW_STR:
	MOV AL, CS:[BX][SI]
	CMP AL, 00H
	JZ SHOW_STR_ZERO
	MOV ES:[DI], AL
	MOV BYTE PTR ES:[DI].01H, 03H 
	INC SI
	ADD DI, 0002H
	JMP SHORT SHOW_STR

	SHOW_STR_ZERO:
	POP ES
	POP DI
	POP SI
	POP BX
	POP AX
	RET
		
		

CODE ENDS
	END START
